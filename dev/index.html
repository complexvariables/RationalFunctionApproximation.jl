<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · RationalFunctionApproximation.jl</title><meta name="title" content="Introduction · RationalFunctionApproximation.jl"/><meta property="og:title" content="Introduction · RationalFunctionApproximation.jl"/><meta property="twitter:title" content="Introduction · RationalFunctionApproximation.jl"/><meta name="description" content="Documentation for RationalFunctionApproximation.jl."/><meta property="og:description" content="Documentation for RationalFunctionApproximation.jl."/><meta property="twitter:description" content="Documentation for RationalFunctionApproximation.jl."/><meta property="og:url" content="https://complexvariables.github.io/RationalFunctionApproximation.jl/"/><meta property="twitter:url" content="https://complexvariables.github.io/RationalFunctionApproximation.jl/"/><link rel="canonical" href="https://complexvariables.github.io/RationalFunctionApproximation.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>RationalFunctionApproximation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="algorithms/">Algorithms</a></li><li><a class="tocitem" href="domains/">Domains</a></li><li><a class="tocitem" href="discrete/">Discrete data</a></li><li><a class="tocitem" href="minimax/">Minimax</a></li><li><a class="tocitem" href="python/">Usage from Python</a></li><li><a class="tocitem" href="functions/">Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/complexvariables/RationalFunctionApproximation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/complexvariables/RationalFunctionApproximation.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Rational-function-approximation-in-Julia"><a class="docs-heading-anchor" href="#Rational-function-approximation-in-Julia">Rational function approximation in Julia</a><a id="Rational-function-approximation-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Rational-function-approximation-in-Julia" title="Permalink"></a></h1><p><em>Documentation for <a href="https://github.com/complexvariables/RationalFunctionApproximation.jl">RationalFunctionApproximation.jl</a>.</em></p><p>This package computes rational approximations of a function or data given in the complex plane. For background reading, see [<a href="#NakatsukasaAAAAlgorithm2018">1</a>], [<a href="#DriscollAAARational2024a">2</a>] (or the related arXiv version [<a href="#DriscollAAARational2023a">3</a>]), [<a href="#CostaAAAleastSquares2023">4</a>], and [<a href="#CelisNumericalContinued2024">5</a>].</p><p>A rational function is a ratio of two polynomials. Rational functions are capable of very high accuracy and, unlike polynomial interpolation, do not require the interpolation nodes to be distributed in a highly restricted way. They are a good choice for approximating functions with singularities or other complicated behavior. Also unlike polynomials, however, they do not depend linearly on the data, which has historically made them difficult to compute and work with.</p><p>Here&#39;s a smooth, gentle function on the interval <span>$[-1, 1]$</span>:</p><pre><code class="language-julia hljs">using RationalFunctionApproximation, CairoMakie
CairoMakie.update_theme!(size = (600, 400), fontsize=11)
const shg = current_figure

f = x -&gt; exp(cos(4x) - sin(3x))
lines(-1..1, f)</code></pre><img src="index-f4357621.png" alt="Example block output"/><p>To create a rational function that approximates <span>$f$</span> well on this domain, we make a call to the <code>approximate</code> function:</p><pre><code class="language-julia hljs">r = approximate(f, unit_interval)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Barycentric{Float64, Float64} rational interpolant of type (19, 19) on the domain: Segment(-1.0,1.0)</code></pre><p>The value of <code>unit_interval</code> is defined by the package to be the interval <span>$[-1, 1]$</span>. The result <code>r</code> is a type (19,19) rational approximant that can be evaluated like a function:</p><pre><code class="language-julia hljs">f(0.5) - r(0.5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-6.186717804723685e-14</code></pre><p>We see that this approximation is accurate to about 13 places over the interval:</p><pre><code class="language-julia hljs">z, err = check(r)
lines(z, err)</code></pre><img src="index-190093f2.png" alt="Example block output"/><p>The rational approximant interpolates <span>$f$</span> at nodes that were selected iteratively to represent the function well.</p><pre><code class="language-julia hljs">x = nodes(r)
scatter!(x, 0*x, markersize = 8, color=:black)
shg()</code></pre><img src="index-e55b1d27.png" alt="Example block output"/><p>We could choose to approximate over a wider interval:</p><pre><code class="language-julia hljs">using ComplexRegions
r = approximate(f, Segment(-2, 4))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Barycentric{Float64, Float64} rational interpolant of type (48, 48) on the domain: Segment(-2.0,4.0)</code></pre><p>Note that the degree of the rational function increased to capture the additional complexity.</p><p>One interesting feature of a rational function is that it can have poles, or infinite value, at the roots of the denominator polynomial. In this case, the poles hint at where the function is most sharply peaked:</p><pre><code class="language-julia hljs">poleplot(r)</code></pre><img src="index-71b204de.png" alt="Example block output"/><p>More typically, however, a function that is well-behaved on the real axis has a singularity structure lurking in the complex plane, and the poles of rational functions provide a unique way to cope with them. For instance, let&#39;s try approximating the hyperbolic secant function:</p><pre><code class="language-julia hljs">r = approximate(sech, Segment(-4, 4))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Barycentric{Float64, Float64} rational interpolant of type (10, 10) on the domain: Segment(-4.0,4.0)</code></pre><p>The sech function is smooth on the real axis but has poles on the imaginary axis at odd multiples of <span>$i\pi/2$</span>. The rational approximant automatically locates the poles closest to the domain:</p><pre><code class="language-julia hljs">2 * poles(r) / π</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10-element Vector{ComplexF64}:
    -0.8480537748956253 - 6.958993464534257im
    -0.8480537748956252 + 6.958993464534257im
  -3.800037215431165e-8 - 3.000001474874752im
 -3.8000372154311644e-8 + 3.000001474874753im
 2.9914864491704326e-13 - 0.9999999999989461im
 2.9914864491704326e-13 + 0.9999999999989458im
   3.571865550474971e-5 - 4.993621060758388im
   3.571865550474971e-5 + 4.993621060758388im
     0.8489644277744672 - 6.96037317612887im
     0.8489644277744672 + 6.960373176128869im</code></pre><p>We can use the <a href="https://eprovst.github.io/DomainColoring.jl/stable/">DomainColoring</a> package to visualize the rational function in the complex plane. Color is used to show the phase angle of the value, while dark-to-bright cycles of lightness show powers of e in the magnitude. The poles stand out as locations of rapid change in both phase and magnitude.</p><pre><code class="language-julia hljs">using DomainColoring

domaincolor(r, [-6, 6, -6, 6]; abs=true)
lines!(r.domain, linewidth=3, color=:white)
shg()</code></pre><img src="index-aea84356.png" alt="Example block output"/><p>A meromorphic function such as sech has only those isolated poles as singularities, and getting those right is most of the battle. By contrast, the function <span>$\log(x + 0.05i)$</span> has a branch point at <span>$x = -0.05i$</span> necessitating a branch cut connecting it to infinity. A rational approximant uses poles to construct a proxy branch cut:</p><pre><code class="language-julia hljs">f = x -&gt; log(x + 0.05im)
r = approximate(f, unit_interval)
domaincolor(r, [-1.2, 1.2, -1.2, 1.2]; abs=true)
lines!(r.domain, linewidth=3, color=:white)
shg()</code></pre><img src="index-55855111.png" alt="Example block output"/><p>We close with a function having a singularity that lies on the interval: <span>$|x|$</span>. A famous result of Newman in 1964 proved that the best rational approximation of degree <span>$n$</span> has root-exponential convergence.</p><pre><code class="language-julia hljs">r = approximate(abs, unit_interval; tol=1e-12)
convergenceplot(r)</code></pre><img src="index-37081eb7.png" alt="Example block output"/><p>(The errors increase for odd degrees above because they are being measured at the test points discovered at the end of the iteration, not the ones during the iteration.) We find that the nodes of the approximant are also distributed (nearly) root-exponentially around the singularity:</p><pre><code class="language-julia hljs">z = filter(&gt;(0), nodes(r))
scatter(sort(abs.(z)), axis=(ylabel=&quot;| node |&quot;, yscale=log10,))</code></pre><img src="index-a99aacdc.png" alt="Example block output"/><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="algorithms/#Algorithms">Algorithms</a> describes the algorithms available for rational approximation.</li><li><a href="domains/#Approximation-on-domains">Approximation on domains</a> shows how to approximate functions on different domains.</li><li><a href="discrete/#Discrete-data">Discrete data</a> shows how to approximate data given as points and values rather than as functions.</li><li><a href="minimax/#Minimax-approximation">Minimax approximation</a> explains the difference between the default approximation and minimax approximation.</li><li><a href="python/#Usage-from-Python">Usage from Python</a> shows how to use the package from Python.</li><li><a href="functions/#Functions-and-types">Functions and types</a> collects the documentation strings of the major package features.</li></ul><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><div class="citation canonical"><dl><dt>[1]</dt><dd><div id="NakatsukasaAAAAlgorithm2018">Y. Nakatsukasa, O. Sète and L. N. Trefethen. <em>The AAA Algorithm for Rational Approximation</em>. <a href="https://doi.org/10.1137/16m1106122">SIAM Journal on Scientific Computing <strong>40</strong>, A1494-A1522</a> (2018). Accessed on Jul 14, 2020.</div></dd><dt>[2]</dt><dd><div id="DriscollAAARational2024a">T. A. Driscoll, Y. Nakatsukasa and L. N. Trefethen. <em>AAA Rational Approximation on a Continuum</em>. <a href="https://doi.org/10.1137/23M1570508">SIAM Journal on Scientific Computing <strong>46</strong>, A929-A952</a> (2024). Accessed on May 15, 2025.</div></dd><dt>[3]</dt><dd><div id="DriscollAAARational2023a">T. Driscoll, Y. Nakatsukasa and L. N. Trefethen. <a href="https://doi.org/10.48550/ARXIV.2305.03677"><em>AAA Rational Approximation on a Continuum</em></a> (2023). Accessed on Feb 26, 2024.</div></dd><dt>[4]</dt><dd><div id="CostaAAAleastSquares2023">S. Costa and L. N. Trefethen. <a href="https://doi.org/10.4171/8ecm/16"><em>AAA-least Squares Rational Approximation and Solution of Laplace Problems</em></a>. In: <em>European Congress of Mathematics</em>, 1 Edition, edited by A. Hujdurović, K. Kutnar, D. Marušič, Š. Miklavič, T. Pisanski and P. Šparl (EMS Press, 2023); pp. 511–534. Accessed on Oct 5, 2023.</div></dd><dt>[5]</dt><dd><div id="CelisNumericalContinued2024">O. S. Celis. <em>Numerical Continued Fraction Interpolation</em>. <a href="https://doi.org/10.1007/s11253-024-02344-5">Ukrainian Mathematical Journal <strong>76</strong>, 635–648</a> (2024). Accessed on Jan 28, 2025.</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="algorithms/">Algorithms »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 16 May 2025 17:52">Friday 16 May 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
